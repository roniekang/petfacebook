# Pettopia - 기능 스펙 문서

## Phase 1 핵심 기능 (MVP Core)

> Phase 1의 핵심은 다음 3가지입니다:
> 1. **Geo Tag가 있는 사진/동영상 업로드** - 위치 정보가 포함된 미디어 공유
> 2. **집사/친구 관계 형성** - 펫 단위 친구 추가 (QR, 근처 검색, 검색)
> 3. **펫 = 계정** - 집사가 1펫에 대해 1계정 생성, 펫이 모든 활동의 주체

## 배포 & 인프라

- **Docker Compose** 기반 컨테이너 배포 (DB, API, Web, Storage)
- **모바일 지원**: PWA (Progressive Web App)로 폰에서 사진 촬영/업로드 가능
- **파일 스토리지**: MinIO (S3 호환) - 사진/동영상 저장

## Phase 1 기능 상세 스펙

---

### 1. 인증 (Auth)

#### 1.1 회원가입
- **방식**: 이메일 + 비밀번호, 소셜 로그인 (Google, Kakao, Naver)
- **필수 정보**: 이메일, 비밀번호, 닉네임
- **선택 정보**: 프로필 사진, 소개글
- **유효성 검사**: 이메일 형식, 비밀번호 강도 (8자 이상, 영문+숫자)
- **이메일 인증**: 가입 후 이메일 인증 필요

#### 1.2 로그인
- **방식**: 이메일 + 비밀번호, 소셜 로그인
- **토큰**: JWT (Access Token: 1시간, Refresh Token: 7일)
- **자동 로그인**: Refresh Token 기반

#### 1.3 Geo IP 기반 지역 설정
- **자동 감지**: 로그인 시 IP 기반으로 지역 자동 감지
- **수동 설정**: 사용자가 직접 지역 변경 가능
- **지역 단위**: 시/도 > 시/군/구 > 동/읍/면

---

### 2. 사용자 프로필 (User)

#### 2.1 프로필 관리
- 닉네임, 프로필 사진, 소개글 수정
- 지역 정보 표시
- 내 펫 목록 표시
- 활동 히스토리 (게시글, 스토리 등)

---

### 3. 펫 프로필 (Pet)

#### 3.1 펫 등록
- **필수 정보**: 이름, 종류 (개, 고양이, 새, 기타), 품종, 생년월일, 성별
- **선택 정보**: 프로필 사진, 성격, 좋아하는 것, 특이사항
- **상태**: 함께하는 중 / Pet Haven (무지개 다리)

#### 3.2 복수 보호자 시스템
- 하나의 펫에 여러 보호자 연결 가능
- **역할 구분**: 주 보호자(사람1), 공동 보호자(사람2, 사람3...)
- 주 보호자가 공동 보호자 초대/삭제 가능
- 모든 보호자가 펫 프로필 조회/활동 기록 가능
- **폰 앱 기반**: 집사(보호자)들끼리 동물의 친구를 추가 가능
  - QR 코드 또는 펫 검색으로 친구 요청
  - 산책 중 만난 펫에게 바로 친구 추가 (근처 기반)

#### 3.3 펫 활동 기록
- 산책 (경로, 시간, 거리 - Geo 기반)
- 놀이 기록
- 건강 기록 (체중, 예방접종, 병원 방문)
- 식사 기록

---

### 4. 피드 / 게시글 (Post)

#### 4.1 게시글 작성
- 텍스트 + 사진 (최대 10장) 조합
- 펫 태그 (어떤 펫의 이야기인지)
- 위치 태그 (Geo Tag)
- 공개 범위: 전체 공개 / 친구만 / 비공개

#### 4.2 피드
- 시간순 정렬 (최신순)
- 친구 펫의 게시글 우선 표시
- 지역 기반 추천 게시글
- 좋아요, 댓글 기능

#### 4.3 사진 업로드
- 이미지 리사이즈 및 최적화
- 다중 이미지 업로드
- 이미지 필터 (기본)

---

### 5. 스토리 (Story)

#### 5.1 스토리 생성
- 사진/동영상 기반 (24시간 후 자동 삭제)
- 배경 효과 / 물리 효과 적용
- 사진 → 동적 영상 변환 기능
- Geo Tag 기반 위치 표시

#### 5.2 스토리 조회
- 상단 스토리 바에서 확인
- Geo Tag 기반 지역별 필터링

---

### 6. 친구 시스템 (Friend)

#### 6.1 펫 기반 친구 추가
- **핵심**: 사람이 아닌 **펫 단위**로 친구 관계 형성
- 집사(보호자)가 폰 앱을 통해 자신의 펫의 친구를 추가
- 친구 요청 → 상대 보호자가 수락/거절

#### 6.2 친구 추가 방식
- **QR 코드 스캔**: 오프라인에서 만난 펫과 즉시 친구 추가
- **근처 펫 검색**: GPS 기반으로 근처의 펫 발견 및 친구 요청
- **이름/닉네임 검색**: 직접 검색으로 친구 추가
- **지역 기반 추천**: 같은 동네에 사는 펫 추천

#### 6.3 온라인 친구 활동
- 친구 펫의 피드 구독
- 친구 펫의 스토리 확인
- 메시지 (보호자 간)

#### 6.4 오프라인 연결
- 산책 모임에서의 친구 매칭
- 지역 커뮤니티에서 친구 발견

---

### 7. 지역 커뮤니티 (Community)

#### 7.1 커뮤니티 생성/참여
- 지역 기반 자동 커뮤니티 (예: "강남구 반려동물")
- 관심사 기반 커뮤니티 (예: "골든리트리버 모임")
- 커뮤니티 게시판, 공지사항

#### 7.2 소통
- 커뮤니티 내 게시글 작성
- 정보 공유 (동물병원 추천, 사료 후기 등)

---

### 8. 산책 모임 (Walk)

#### 8.1 모임 생성
- 날짜, 시간, 장소, 참여 인원 제한
- 산책 코스 설정 (지도 연동)
- 반복 모임 설정 (매주 등)

#### 8.2 모임 참여
- 근처 산책 모임 검색
- 참여 신청/승인
- 실시간 참여자 위치 (산책 중)

---

### 9. 생활 서비스 (Service)

#### 9.1 동물병원
- 지역 기반 동물병원 목록
- 병원 정보 (위치, 영업시간, 연락처, 진료 분야)
- 사용자 리뷰/평점
- 지도에서 보기

#### 9.2 펫 보험
- 펫 보험 상품 목록
- 보험 비교 (보장 내용, 가격)
- 보험사 연결 (외부 링크)

---

### 10. Pet Haven (추모 공간)

#### 10.1 메모리얼 생성
- 펫 상태를 "Pet Haven"으로 변경
- 추모 페이지 자동 생성
- 추모 메시지 남기기 (다른 사용자도 가능)

#### 10.2 Happy 메모리
- 함께한 사진/영상 자동 모음
- 타임라인 형태로 추억 보기
- "살아있는 것처럼" - AI 기반 사진 애니메이션 (향후)

---

## API 엔드포인트 요약

### Auth
| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/auth/register` | 회원가입 |
| POST | `/auth/login` | 로그인 |
| POST | `/auth/refresh` | 토큰 갱신 |
| POST | `/auth/social/{provider}` | 소셜 로그인 |

### User
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/users/me` | 내 정보 조회 |
| PATCH | `/users/me` | 내 정보 수정 |
| GET | `/users/:id` | 사용자 조회 |

### Pet
| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/pets` | 펫 등록 |
| GET | `/pets/:id` | 펫 조회 |
| PATCH | `/pets/:id` | 펫 수정 |
| DELETE | `/pets/:id` | 펫 삭제 |
| POST | `/pets/:id/guardians` | 보호자 추가 |
| GET | `/pets/:id/activities` | 활동 기록 조회 |
| POST | `/pets/:id/activities` | 활동 기록 |

### Post
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/posts/feed` | 피드 조회 |
| POST | `/posts` | 게시글 작성 |
| GET | `/posts/:id` | 게시글 조회 |
| PATCH | `/posts/:id` | 게시글 수정 |
| DELETE | `/posts/:id` | 게시글 삭제 |
| POST | `/posts/:id/like` | 좋아요 |
| POST | `/posts/:id/comments` | 댓글 작성 |

### Story
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/stories` | 스토리 목록 |
| POST | `/stories` | 스토리 생성 |

### Friend
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/pets/:id/friends` | 펫 친구 목록 |
| POST | `/pets/:id/friends/request` | 친구 요청 |
| POST | `/friends/requests/:id/accept` | 친구 수락 |
| POST | `/friends/requests/:id/reject` | 친구 거절 |
| GET | `/pets/nearby` | 근처 펫 검색 |

### Community
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/communities` | 커뮤니티 목록 |
| POST | `/communities` | 커뮤니티 생성 |
| GET | `/communities/:id` | 커뮤니티 상세 |
| POST | `/communities/:id/join` | 참여 |

### Walk
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/walks` | 산책 모임 목록 |
| POST | `/walks` | 모임 생성 |
| POST | `/walks/:id/join` | 참여 |

### Service
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/services/hospitals` | 동물병원 목록 |
| GET | `/services/hospitals/:id` | 병원 상세 |
| GET | `/services/insurances` | 보험 목록 |

### Haven
| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/pets/:id/haven` | Pet Haven 전환 |
| GET | `/haven/:petId` | 추모 페이지 |
| POST | `/haven/:petId/memories` | 추억 추가 |
| POST | `/haven/:petId/messages` | 추모 메시지 |

### Search
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/search?q={query}` | 통합 검색 |
